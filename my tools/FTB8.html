<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fantasy XI Builder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* COVER PAGE STYLES */
        .cover-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f4c75 0%, #3282b8 50%, #bbe1fa 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .cover-page.hidden {
            opacity: 0;
            transform: scale(0.95);
            pointer-events: none;
        }

        .cover-content {
            text-align: center;
            max-width: 90%;
            animation: coverSlideIn 1.2s ease-out;
        }

        @keyframes coverSlideIn {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .cover-title {
            font-size: clamp(2.5rem, 8vw, 5rem);
            font-weight: bold;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #00ff88, #00d4aa, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(0,255,136,0.5);
            animation: titleGlow 2s ease-in-out infinite alternate;
        }

        @keyframes titleGlow {
            from { filter: brightness(1); }
            to { filter: brightness(1.2); }
        }

        .cover-subtitle {
            font-size: clamp(1rem, 4vw, 1.5rem);
            margin-bottom: 2rem;
            opacity: 0.9;
            animation: subtitleFade 1.5s ease-out 0.3s both;
        }

        @keyframes subtitleFade {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 0.9; transform: translateY(0); }
        }

        .team-name-input {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(0,255,136,0.3);
            border-radius: 25px;
            padding: 15px 25px;
            font-size: clamp(1rem, 4vw, 1.2rem);
            color: white;
            text-align: center;
            width: 100%;
            max-width: 400px;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
            animation: inputSlide 1.8s ease-out 0.6s both;
        }

        @keyframes inputSlide {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .team-name-input:focus {
            outline: none;
            border-color: #00ff88;
            box-shadow: 0 0 20px rgba(0,255,136,0.4);
            transform: scale(1.02);
        }

        .team-name-input::placeholder {
            color: rgba(255,255,255,0.7);
        }

        .start-button {
            background: linear-gradient(135deg, #00ff88, #00d4aa);
            color: #1e3c72;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: clamp(1rem, 4vw, 1.2rem);
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,255,136,0.3);
            animation: buttonBounce 2.1s ease-out 0.9s both;
        }

        @keyframes buttonBounce {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .start-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 40px rgba(0,255,136,0.5);
        }

        .start-button:active {
            transform: translateY(-1px) scale(1.02);
        }

        .floating-elements {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }

        .floating-element {
            position: absolute;
            color: rgba(255,255,255,0.1);
            font-size: 2rem;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        /* MAIN APP STYLES */
        .main-app {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s ease;
            padding: 20px;
        }

        .main-app.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: clamp(1.8rem, 6vw, 2.5rem);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
        }

        .pitch-container {
            background: linear-gradient(to bottom, #2d5016 0%, #4a7c59 50%, #2d5016 100%);
            border-radius: 15px;
            padding: 30px;
            position: relative;
            min-height: 600px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .formation-line {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 20px 0;
            position: relative;
            z-index: 2;
        }

        .player-slot {
            width: 80px;
            height: 80px;
            border: 3px dashed rgba(255,255,255,0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            font-size: 12px;
            font-weight: bold;
        }

        .player-slot:hover {
            border-color: #00ff88;
            background: rgba(0,255,136,0.2);
            transform: scale(1.1);
        }

        .player-slot.filled {
            border: 3px solid #00ff88;
            background: linear-gradient(135deg, #00ff88, #00d4aa);
            color: #000;
            font-weight: bold;
            font-size: 10px;
            text-align: center;
            padding: 5px;
        }

        .sidebar {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 25px;
            height: fit-content;
            max-height: 90vh;
            overflow-y: auto;
        }

        .team-stats {
            margin-bottom: 30px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            font-size: 14px;
        }

        .stat-value {
            font-weight: bold;
            color: #00ff88;
        }

        .formation-selector {
            margin-bottom: 20px;
        }

        .formation-selector select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: none;
            background: rgba(255,255,255,0.2);
            color: white;
            font-size: 14px;
        }

        .formation-selector select option {
            background: #1e3c72;
            color: white;
        }

        .team-name-section {
            margin-bottom: 20px;
        }

        .team-name-section input {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: none;
            background: rgba(255,255,255,0.2);
            color: white;
            font-size: 14px;
        }

        .player-pool {
            margin-top: 20px;
        }

        /* Collapsible section for player groups */
        .position-group details {
            margin-bottom: 15px;
            background: rgba(255,255,255,0.08);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.15);
        }

        .position-group summary {
            padding: 12px 15px;
            font-weight: bold;
            color: #00ff88;
            font-size: 14px;
            text-transform: uppercase;
            cursor: pointer;
            list-style: none; /* Hide default triangle/arrow */
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0,0,0,0.1);
            transition: background 0.2s ease;
        }

        .position-group summary:hover {
            background: rgba(0,0,0,0.2);
        }

        .position-group summary::after {
            content: '+';
            font-size: 1.2em;
            transition: transform 0.2s ease;
        }

        .position-group details[open] summary::after {
            content: '-';
            transform: rotate(0deg); /* No rotation needed for - */
        }

        .player-list {
            display: grid;
            /* Use auto-fit to adjust columns based on available space */
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); 
            gap: 8px;
            padding: 10px 15px 15px; /* Padding inside the details content */
        }

        .player-card {
            background: rgba(255,255,255,0.15);
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .player-card:hover {
            background: rgba(255,255,255,0.25);
            transform: translateX(5px);
        }

        .player-card.selected {
            background: rgba(0,255,136,0.3);
            border: 2px solid #00ff88;
        }

        .player-rating {
            color: #00ff88;
            font-weight: bold;
        }

        .advice-section {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }

        .advice-title {
            color: #00ff88;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .advice-text {
            font-size: 14px;
            line-height: 1.4;
        }

        .clear-team {
            background: linear-gradient(135deg, #ff4757, #ff3742);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 20px;
            width: 100%;
            transition: all 0.3s ease;
        }

        .clear-team:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255,71,87,0.4);
        }

        /* MOBILE RESPONSIVE STYLES */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .pitch-container {
                padding: 20px;
                min-height: 500px;
            }
            
            .player-slot {
                width: 60px;
                height: 60px;
                font-size: 10px;
            }
            
            .sidebar {
                padding: 20px;
                max-height: none; /* Allow sidebar to naturally expand */
                overflow-y: visible; /* Allow content to push sidebar height */
            }
            
            .formation-line {
                margin: 15px 0;
            }
            
            .stat-item {
                font-size: 12px;
                padding: 8px;
            }
            
            .player-card {
                font-size: 12px;
                padding: 8px;
            }
            
            .advice-text {
                font-size: 13px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 0;
            }
            
            .pitch-container {
                padding: 15px;
                min-height: 400px;
            }
            
            .player-slot {
                width: 50px;
                height: 50px;
                font-size: 9px;
            }
            
            .sidebar {
                padding: 15px;
            }
            
            .formation-line {
                margin: 10px 0;
            }
            
            .header h1 {
                margin-bottom: 5px;
            }
        }

        /* LINEUP MODAL STYLES */
        .lineup-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .lineup-modal-content {
            background: linear-gradient(135deg, #0f4c75, #3282b8, #bbe1fa);
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            width: 100%;
            color: white;
            text-align: center;
            position: relative;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            max-height: 90vh;
            overflow-y: auto;
        }

        .lineup-header {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 25px;
        }

        .lineup-pitch {
            background: linear-gradient(to bottom, #2d5016 0%, #4a7c59 50%, #2d5016 100%);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            position: relative;
            min-height: 300px;
        }

        .lineup-display {
            display: grid;
            gap: 15px;
            height: 100%;
            position: relative;
            z-index: 2;
            grid-template-rows: 1fr 1fr 1fr 1fr;
            grid-template-columns: 1fr;
            align-items: center;
            justify-items: center;
        }

        .lineup-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .lineup-button {
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .share-btn {
            background: linear-gradient(135deg, #00ff88, #00d4aa);
            color: black;
            box-shadow: 0 5px 15px rgba(0,255,136,0.3);
        }

        .close-btn {
            background: linear-gradient(135deg, #ff4757, #ff3742);
            color: white;
            box-shadow: 0 5px 15px rgba(255,71,87,0.3);
        }

        @media (max-width: 480px) {
            .lineup-modal-content {
                padding: 20px;
                margin: 10px;
            }
            
            .lineup-pitch {
                padding: 15px;
                min-height: 250px;
            }
            
            .lineup-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .lineup-button {
                width: 100%;
            }
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 15px;
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.7);
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
   #share-options-modal {
    z-index: 1501 !important;

        }
    </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="cover-page" id="coverPage">
        <div class="floating-elements">
            <div class="floating-element" style="top: 10%; left: 10%; animation-delay: 0s;">⚽</div>
            <div class="floating-element" style="top: 20%; right: 15%; animation-delay: 1s;">🏆</div>
            <div class="floating-element" style="bottom: 30%; left: 20%; animation-delay: 2s;">⭐</div>
            <div class="floating-element" style="bottom: 20%; right: 10%; animation-delay: 3s;">🔥</div>
            <div class="floating-element" style="top: 50%; left: 5%; animation-delay: 4s;">⚡</div>
            <div class="floating-element" style="top: 60%; right: 5%; animation-delay: 5s;">🎯</div>
        </div>
        
        <div class="cover-content">
            <h1 class="cover-title">⚽ Fantasy XI Builder</h1>
            <p class="cover-subtitle">Build your dream team and dominate the pitch!</p>
            
            <input type="text" 
                   class="team-name-input" 
                   id="coverTeamName" 
                   placeholder="Enter your team name..."
                   maxlength="30">
            
            <div>
                <button class="start-button" onclick="startApp()">
                    🚀 Start Building
                </button>
            </div>
        </div>
    </div>

    <div class="main-app" id="mainApp">
        <div class="container">
            <div class="header">
                <h1 id="mainTitle">⚽ Fantasy XI Builder</h1>
                <p>Build your dream team and see how they stack up!</p>
            </div>

            <div class="main-content">
                <div class="pitch-container">
                    <div class="formation-line" id="forwards">
                        </div>
                    <div class="formation-line" id="midfielders">
                        </div>
                    <div class="formation-line" id="defenders">
                        </div>
                    <div class="formation-line" id="goalkeeper">
                        </div>
                </div>

                <div class="sidebar">
                    <div class="formation-selector">
                        <label for="formation">Formation:</label>
                        <select id="formation" onchange="changeFormation()">
                            <option value="4-3-3">4-3-3</option>
                            <option value="4-4-2">4-4-2</option>
                            <option value="3-5-2">3-5-2</option>
                            <option value="4-2-3-1">4-2-3-1</option>
                        </select>
                    </div>

                    <div class="team-name-section">
                        <label for="team-name" style="display: block; margin-bottom: 8px; color: #00ff88; font-weight: bold;">⚽ Team Name:</label>
                        <input type="text" id="team-name" placeholder="Enter your team name..." 
                               oninput="updateTeamName()">
                    </div>

                    <div class="team-stats">
                        <h3>Team Statistics</h3>
                        <div class="stat-item">
                            <span>Overall Rating:</span>
                            <span class="stat-value" id="overall-rating">0/100</span>
                        </div>
                        <div class="stat-item">
                            <span>Attack:</span>
                            <span class="stat-value" id="attack-rating">0/100</span>
                        </div>
                        <div class="stat-item">
                            <span>Midfield:</span>
                            <span class="stat-value" id="midfield-rating">0/100</span>
                        </div>
                        <div class="stat-item">
                            <span>Defense:</span>
                            <span class="stat-value" id="defense-rating">0/100</span>
                        </div>
                        <div class="stat-item">
                            <span>Players:</span>
                            <span class="stat-value" id="player-count">0/11</span>
                        </div>
                    </div>

                    <div class="player-pool">
                        <h3>Available Players</h3>
                        
                        <div class="position-group">
                            <details open> <summary>Goalkeepers</summary>
                                <div class="player-list" id="gk-players"></div>
                            </details>
                        </div>
                        
                        <div class="position-group">
                            <details open>
                                <summary>Defenders</summary>
                                <div class="player-list" id="def-players"></div>
                            </details>
                        </div>
                        
                        <div class="position-group">
                            <details open>
                                <summary>Midfielders</summary>
                                <div class="player-list" id="mid-players"></div>
                            </details>
                        </div>
                        
                        <div class="position-group">
                            <details open>
                                <summary>Forwards</summary>
                                <div class="player-list" id="fwd-players"></div>
                            </details>
                        </div>
                    </div>

                    <div class="advice-section">
                        <div class="advice-title">💡 Smart Suggestions</div>
                        <div class="advice-text" id="team-advice">
                            Select players to build your team and get strategic advice!
                        </div>
                    </div>

                    <div class="advice-section" id="smart-suggestions" style="display: none;">
                        <div class="advice-title">🎯 Recommended Players</div>
                        <div id="player-suggestions" style="display: grid; gap: 5px; margin-top: 10px;">
                        </div>
                    </div>

                    <button class="clear-team" onclick="clearTeam()">🗑️ Clear Team</button>
                    <button class="clear-team" onclick="showLineupCard()" style="background: linear-gradient(135deg, #00ff88, #00d4aa); margin-top: 10px;" id="lineup-btn" disabled>📋 Show Lineup Card</button>
                </div>
            </div>
            <div class="footer">
                &copy; ssmoon
            </div>
        </div>
    </div>

    <div class="lineup-modal" id="lineup-modal">
        <div class="lineup-modal-content">
            <div class="lineup-header">
                <h2 id="lineup-team-name">My Dream Team</h2>
                <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 14px;">
                    <span id="lineup-formation">4-3-3</span>
                    <span id="lineup-rating">Rating: 85/100</span>
                </div>
            </div>
 <div id="share-options-modal" class="lineup-modal">
  <div class="lineup-modal-content" style="text-align: center;">
    <h2 style="margin-bottom: 10px;">📤 Share Your Team</h2>
    <p style="margin-bottom: 20px;">Choose a platform to share your team card:</p>
    <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
      <button class="lineup-button share-btn" onclick="shareToPlatform('facebook')">Facebook</button>
      <button class="lineup-button share-btn" onclick="shareToPlatform('x')">X (Twitter)</button>
      <button class="lineup-button share-btn" onclick="shareToPlatform('telegram')">Telegram</button>
      <button class="lineup-button share-btn" onclick="shareToPlatform('instagram')">Instagram</button>
      <button class="lineup-button share-btn" onclick="shareToPlatform('kakao')">KakaoTalk</button>
    </div>
    <button class="lineup-button close-btn" style="margin-top: 20px;" onclick="closeShareOptions()">Close</button>
  </div>
</div>


            <div class="lineup-pitch">
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 2px; height: 100%; background: rgba(255,255,255,0.4);"></div>
                <div style="position: absolute; top: 50%; left: 0; right: 0; height: 2px; background: rgba(255,255,255,0.4);"></div>
                
                <div class="lineup-display" id="lineup-display">
                </div>
            </div>

            <div class="lineup-buttons">
    <button class="lineup-button share-btn" onclick="shareLineup()">📱 Share Team</button>
    <button class="lineup-button share-btn" onclick="downloadLineupImage()">🖼️ Download Card</button>
    <button class="lineup-button close-btn" onclick="closeLineupModal()">Close</button>
</div>

        </div>
    </div>

    <script>
        // Player database with ratings
        const players = {
            goalkeepers: [
                {name: "Neuer", rating: 89, country: "GER"},
                {name: "Alisson", rating: 87, country: "BRA"},
                {name: "Ter Stegen", rating: 86, country: "GER"},
                {name: "Courtois", rating: 86, country: "BEL"},
                {name: "Oblak", rating: 85, country: "SLO"},
                {name: "Emi Martinez", rating: 84, country: "ARG"},
                {name: "Donnarumma", rating: 83, country: "ITA"}
            ],
            defenders: [
                {name: "Van Dijk", rating: 89, country: "NED"},
                {name: "Ramos", rating: 86, country: "ESP"},
                {name: "Marquinhos", rating: 85, country: "BRA"},
                {name: "Kimmich", rating: 88, country: "GER"},
                {name: "Cancelo", rating: 86, country: "POR"},
                {name: "Robertson", rating: 84, country: "SCO"},
                {name: "Alphonso Davies", rating: 83, country: "CAN"},
                {name: "Reece James", rating: 82, country: "ENG"},
                {name: "Balde", rating: 81, country: "ESP"}
            ],
            midfielders: [
                {name: "De Bruyne", rating: 91, country: "BEL"},
                {name: "Modrić", rating: 87, country: "CRO"},
                {name: "Casemiro", rating: 85, country: "BRA"},
                {name: "Kante", rating: 84, country: "FRA"},
                {name: "Pedri", rating: 83, country: "ESP"},
                {name: "Mount", rating: 82, country: "ENG"},
                {name: "Bellingham", rating: 84, country: "ENG"},
                {name: "Bruno Fernandes", rating: 86, country: "POR"},
                {name: "Gavi", rating: 82, country: "ESP"}
            ],
            forwards: [
                {name: "Messi", rating: 91, country: "ARG"},
                {name: "Lewandowski", rating: 89, country: "POL"},
                {name: "Mbappé", rating: 90, country: "FRA"},
                {name: "Haaland", rating: 88, country: "NOR"},
                {name: "Neymar", rating: 87, country: "BRA"},
                {name: "Salah", rating: 86, country: "EGY"},
                {name: "Kane", rating: 85, country: "ENG"},
                {name: "Benzema", rating: 86, country: "FRA"}
            ]
        };

        // Team formation configurations
        const formations = {
            "4-3-3": {defenders: 4, midfielders: 3, forwards: 3},
            "4-4-2": {defenders: 4, midfielders: 4, forwards: 2},
            "3-5-2": {defenders: 3, midfielders: 5, forwards: 2},
            "4-2-3-1": {defenders: 4, midfielders: 5, forwards: 1}
        };

        let selectedTeam = {
            goalkeeper: null,
            defenders: [],
            midfielders: [],
            forwards: []
        };

        let currentFormation = "4-3-3";
        let teamName = "My Dream Team";
        let currentSelectionPosition = null;
        let currentSelectionIndex = null;

        // Start the app from cover page
        function startApp() {
            const coverPage = document.getElementById('coverPage');
            const mainApp = document.getElementById('mainApp');
            const coverTeamName = document.getElementById('coverTeamName').value;
            
            // Set team name from cover page
            if (coverTeamName.trim()) {
                teamName = coverTeamName.trim();
                document.getElementById('team-name').value = teamName;
                document.getElementById('mainTitle').textContent = `⚽ ${teamName}`;
            }
            
            // Hide cover page and show main app
            coverPage.classList.add('hidden');
            setTimeout(() => {
                coverPage.style.display = 'none';
                mainApp.classList.add('visible');
            }, 800);
            
            // Initialize the app
            init();
        }

        // Allow Enter key to start app
        document.addEventListener('DOMContentLoaded', function() {
            const coverInput = document.getElementById('coverTeamName');
            coverInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startApp();
                }
            });
        });

        // Initialize the app
        function init() {
            renderPlayerPool();
            changeFormation();
            updateTeamStats();
        }

        // Render available players
        function renderPlayerPool() {
            const positions = ['gk', 'def', 'mid', 'fwd'];
            const positionMap = {
                'gk': 'goalkeepers',
                'def': 'defenders', 
                'mid': 'midfielders',
                'fwd': 'forwards'
            };

            positions.forEach(pos => {
                const container = document.getElementById(`${pos}-players`);
                const playerList = players[positionMap[pos]];
                
                container.innerHTML = playerList.map(player => `
                    <div class="player-card" onclick="selectPlayer('${player.name}', '${positionMap[pos]}', ${player.rating})">
                        ${player.name} 
                        <span class="player-rating">${player.rating}</span>
                    </div>
                `).join('');
            });
        }

        // Change formation and update pitch
        function changeFormation() {
            currentFormation = document.getElementById('formation').value;
            const config = formations[currentFormation];
            
            // Clear current team when changing formation
            selectedTeam = {
                goalkeeper: null,
                defenders: [],
                midfielders: [],
                forwards: []
            };

            // Render positions based on formation
            document.getElementById('goalkeeper').innerHTML = 
                '<div class="player-slot" onclick="openPlayerSelection(\'goalkeeper\')">GK</div>';
            
            document.getElementById('defenders').innerHTML = 
                Array(config.defenders).fill().map((_, i) => 
                    `<div class="player-slot" onclick="openPlayerSelection('defenders', ${i})">DEF</div>`
                ).join('');
            
            document.getElementById('midfielders').innerHTML = 
                Array(config.midfielders).fill().map((_, i) => 
                    `<div class="player-slot" onclick="openPlayerSelection('midfielders', ${i})">MID</div>`
                ).join('');
            
            document.getElementById('forwards').innerHTML = 
                Array(config.forwards).fill().map((_, i) => 
                    `<div class="player-slot" onclick="openPlayerSelection('forwards', ${i})">FWD</div>`
                ).join('');

            updateTeamStats();
            updatePlayerAvailability();
            generateAdvice(); // Update advice based on new empty team
            showSmartSuggestions(); // Update suggestions
        }

        // Open player selection for a position
        function openPlayerSelection(position, index = null) {
            currentSelectionPosition = position;
            currentSelectionIndex = index;
            
            // Highlight available players for this position
            updatePlayerAvailability();
        }

        // Select a player for the team
        function selectPlayer(playerName, playerPosition, rating) {
            if (!currentSelectionPosition) {
                alert('Please click on a position slot first!');
                return;
            }

            const player = {name: playerName, rating: rating};

            // Check if player is already in the team
            const isPlayerInTeam = Object.values(selectedTeam).flat().some(p => p && p.name === playerName);
            if (isPlayerInTeam) {
                alert(`${playerName} is already in your team!`);
                return;
            }

            // Check if position matches selection
            const positionMap = {
                'goalkeepers': 'goalkeeper',
                'defenders': 'defenders',
                'midfielders': 'midfielders',
                'forwards': 'forwards'
            };

            if (positionMap[playerPosition] !== currentSelectionPosition) {
                alert('Player position does not match selected slot!');
                return;
            }

            // Add player to team
            if (currentSelectionPosition === 'goalkeeper') {
                selectedTeam.goalkeeper = player;
            } else {
                if (currentSelectionIndex !== null) {
                    selectedTeam[currentSelectionPosition][currentSelectionIndex] = player;
                }
            }

            updatePitchDisplay();
            updateTeamStats();
            generateAdvice();
            updatePlayerAvailability();
            showSmartSuggestions(); // Add smart suggestions
            currentSelectionPosition = null; // Clear selection after adding player
            currentSelectionIndex = null;
        }

        // Update team name
        function updateTeamName() {
            teamName = document.getElementById('team-name').value || "My Dream Team";
            document.getElementById('mainTitle').textContent = `⚽ ${teamName}`;
        }

        // Show smart player suggestions
        function showSmartSuggestions() {
            const suggestionsContainer = document.getElementById('smart-suggestions');
            const suggestionsDiv = document.getElementById('player-suggestions');
            
            const totalPlayers = (selectedTeam.goalkeeper ? 1 : 0) + 
                               selectedTeam.defenders.filter(p => p).length +
                               selectedTeam.midfielders.filter(p => p).length +
                               selectedTeam.forwards.filter(p => p).length;

            if (totalPlayers === 0 || totalPlayers === 11) {
                suggestionsContainer.style.display = 'none';
                return;
            }

            const config = formations[currentFormation];
            let suggestions = [];

            // Helper to get top available player
            const getTopAvailable = (playerList, selectedList) => {
                return playerList.filter(p => !selectedList.some(selected => selected && selected.name === p.name))
                                 .sort((a, b) => b.rating - a.rating)[0];
            };

            // Suggest based on missing positions
            if (!selectedTeam.goalkeeper) {
                const topGK = getTopAvailable(players.goalkeepers, [selectedTeam.goalkeeper]);
                if (topGK) suggestions.push({player: topGK, position: 'goalkeepers', reason: 'Essential goalkeeper'});
            }

            if (selectedTeam.defenders.filter(p => p).length < config.defenders) {
                const topDefender = getTopAvailable(players.defenders, selectedTeam.defenders);
                if (topDefender) suggestions.push({player: topDefender, position: 'defenders', reason: 'Strengthen defense'});
            }

            if (selectedTeam.midfielders.filter(p => p).length < config.midfielders) {
                const topMidfielder = getTopAvailable(players.midfielders, selectedTeam.midfielders);
                if (topMidfielder) suggestions.push({player: topMidfielder, position: 'midfielders', reason: 'Control the midfield'});
            }

            if (selectedTeam.forwards.filter(p => p).length < config.forwards) {
                const topForward = getTopAvailable(players.forwards, selectedTeam.forwards);
                if (topForward) suggestions.push({player: topForward, position: 'forwards', reason: 'Need goals!'});
            }

            if (suggestions.length > 0) {
                suggestionsContainer.style.display = 'block';
                suggestionsDiv.innerHTML = suggestions.slice(0, 3).map(suggestion => `
                    <div style="background: rgba(0,255,136,0.15); padding: 8px; border-radius: 6px; cursor: pointer; border: 1px solid rgba(0,255,136,0.3); font-size: 12px;" 
                         onclick="quickAddPlayer('${suggestion.player.name}', '${suggestion.position}', ${suggestion.player.rating})">
                        <strong>${suggestion.player.name}</strong> (${suggestion.player.rating}) - ${suggestion.reason}
                        <div style="color: #00ff88; font-size: 10px;">Click to add →</div>
                    </div>
                `).join('');
            } else {
                suggestionsContainer.style.display = 'none';
            }
        }

        // Quick add player from suggestions
        function quickAddPlayer(playerName, playerPosition, rating) {
            const player = {name: playerName, rating: rating};
            const config = formations[currentFormation];

            // Check if player is already in the team
            const isPlayerInTeam = Object.values(selectedTeam).flat().some(p => p && p.name === playerName);
            if (isPlayerInTeam) {
                alert(`${playerName} is already in your team!`);
                return;
            }

            // Add to appropriate position
            if (playerPosition === 'goalkeepers' && !selectedTeam.goalkeeper) {
                selectedTeam.goalkeeper = player;
            } else if (playerPosition === 'defenders' && selectedTeam.defenders.filter(p => p).length < config.defenders) {
                const emptyIndex = selectedTeam.defenders.findIndex(p => !p);
                if (emptyIndex !== -1) {
                    selectedTeam.defenders[emptyIndex] = player;
                } else {
                    selectedTeam.defenders.push(player);
                }
            } else if (playerPosition === 'midfielders' && selectedTeam.midfielders.filter(p => p).length < config.midfielders) {
                const emptyIndex = selectedTeam.midfielders.findIndex(p => !p);
                if (emptyIndex !== -1) {
                    selectedTeam.midfielders[emptyIndex] = player;
                } else {
                    selectedTeam.midfielders.push(player);
                }
            } else if (playerPosition === 'forwards' && selectedTeam.forwards.filter(p => p).length < config.forwards) {
                const emptyIndex = selectedTeam.forwards.findIndex(p => !p);
                if (emptyIndex !== -1) {
                    selectedTeam.forwards[emptyIndex] = player;
                } else {
                    selectedTeam.forwards.push(player);
                }
            }

            updatePitchDisplay();
            updateTeamStats();
            generateAdvice();
            showSmartSuggestions();
            updatePlayerAvailability();
        }

        // Update pitch display with selected players
        function updatePitchDisplay() {
            // Reset all slots to empty state
            document.querySelectorAll('.player-slot').forEach(slot => {
                slot.classList.remove('filled');
                const positionDiv = slot.closest('.formation-line');
                if (positionDiv) {
                    if (positionDiv.id === 'goalkeeper') slot.textContent = 'GK';
                    else if (positionDiv.id === 'defenders') slot.textContent = 'DEF';
                    else if (positionDiv.id === 'midfielders') slot.textContent = 'MID';
                    else if (positionDiv.id === 'forwards') slot.textContent = 'FWD';
                }
            });

            // Update goalkeeper
            if (selectedTeam.goalkeeper) {
                const gkSlot = document.querySelector('#goalkeeper .player-slot');
                gkSlot.textContent = selectedTeam.goalkeeper.name;
                gkSlot.classList.add('filled');
            }

            // Update outfield players
            ['defenders', 'midfielders', 'forwards'].forEach(position => {
                const slots = document.querySelectorAll(`#${position} .player-slot`);
                selectedTeam[position].forEach((player, index) => {
                    if (player && slots[index]) {
                        slots[index].textContent = player.name;
                        slots[index].classList.add('filled');
                    }
                });
            });
        }

        // Update team statistics
        function updateTeamStats() {
            let totalRating = 0;
            let playerCount = 0;
            let attackRating = 0;
            let midfieldRating = 0;
            let defenseRating = 0;
            let numForwards = 0;
            let numMidfielders = 0;
            let numDefenders = 0;

            // Count goalkeeper
            if (selectedTeam.goalkeeper) {
                totalRating += selectedTeam.goalkeeper.rating;
                defenseRating += selectedTeam.goalkeeper.rating;
                playerCount++;
            }

            // Count outfield players
            selectedTeam.defenders.forEach(player => {
                if (player) {
                    totalRating += player.rating;
                    defenseRating += player.rating;
                    playerCount++;
                    numDefenders++;
                }
            });
            selectedTeam.midfielders.forEach(player => {
                if (player) {
                    totalRating += player.rating;
                    midfieldRating += player.rating;
                    playerCount++;
                    numMidfielders++;
                }
            });
            selectedTeam.forwards.forEach(player => {
                if (player) {
                    totalRating += player.rating;
                    attackRating += player.rating;
                    playerCount++;
                    numForwards++;
                }
            });

            // Update display
            document.getElementById('overall-rating').textContent = 
                playerCount > 0 ? `${Math.round(totalRating / playerCount)}/100` : '0/100';
            
            document.getElementById('attack-rating').textContent = 
                numForwards > 0 ? 
                `${Math.round(attackRating / numForwards)}/100` : '0/100';
            
            document.getElementById('midfield-rating').textContent = 
                numMidfielders > 0 ? 
                `${Math.round(midfieldRating / numMidfielders)}/100` : '0/100';
            
            document.getElementById('defense-rating').textContent = 
                (numDefenders + (selectedTeam.goalkeeper ? 1 : 0)) > 0 ? 
                `${Math.round(defenseRating / (numDefenders + (selectedTeam.goalkeeper ? 1 : 0)))}/100` : '0/100';
            
            document.getElementById('player-count').textContent = `${playerCount}/11`;

            // Enable lineup button if team is complete
            const lineupBtn = document.getElementById('lineup-btn');
            if (playerCount === 11) {
                lineupBtn.disabled = false;
                lineupBtn.style.opacity = '1';
            } else {
                lineupBtn.disabled = true;
                lineupBtn.style.opacity = '0.5';
            }
        }

        // Show lineup card modal
        function showLineupCard() {
            const modal = document.getElementById('lineup-modal');
            const display = document.getElementById('lineup-display');
            
            // Update team name and stats in modal
            document.getElementById('lineup-team-name').textContent = teamName;
            document.getElementById('lineup-formation').textContent = `Formation: ${currentFormation}`;
            document.getElementById('lineup-rating').textContent = `Rating: ${document.getElementById('overall-rating').textContent}`;

            // Create real football formation layout
            const config = formations[currentFormation];
            
            // Setup grid based on formation
            display.style.gridTemplateRows = '1fr 1fr 1fr 1fr';
            display.style.gridTemplateColumns = '1fr';
            display.style.alignItems = 'center';
            display.style.justifyItems = 'center';

            let formationHTML = '';

            // Forwards (top)
            formationHTML += '<div style="display: flex; justify-content: space-around; width: 100%; align-items: center;">';
            selectedTeam.forwards.filter(p => p).forEach((player, index) => {
                formationHTML += `
                    <div style="background: rgba(255,255,255,0.9); color: #1e3c72; padding: 8px 12px; border-radius: 20px; font-size: 11px; font-weight: bold; text-align: center; min-width: 60px; box-shadow: 0 3px 10px rgba(0,0,0,0.3);">
                        <div>${player.name}</div>
                        <div style="font-size: 9px; color: #666;">${player.rating}</div>
                    </div>
                `;
            });
            formationHTML += '</div>';

            // Midfielders
            formationHTML += '<div style="display: flex; justify-content: space-around; width: 100%; align-items: center;">';
            selectedTeam.midfielders.filter(p => p).forEach((player, index) => {
                formationHTML += `
                    <div style="background: rgba(255,255,255,0.9); color: #1e3c72; padding: 8px 12px; border-radius: 20px; font-size: 11px; font-weight: bold; text-align: center; min-width: 60px; box-shadow: 0 3px 10px rgba(0,0,0,0.3);">
                        <div>${player.name}</div>
                        <div style="font-size: 9px; color: #666;">${player.rating}</div>
                    </div>
                `;
            });
            formationHTML += '</div>';

            // Defenders
            formationHTML += '<div style="display: flex; justify-content: space-around; width: 100%; align-items: center;">';
            selectedTeam.defenders.filter(p => p).forEach((player, index) => {
                formationHTML += `
                    <div style="background: rgba(255,255,255,0.9); color: #1e3c72; padding: 8px 12px; border-radius: 20px; font-size: 11px; font-weight: bold; text-align: center; min-width: 60px; box-shadow: 0 3px 10px rgba(0,0,0,0.3);">
                        <div>${player.name}</div>
                        <div style="font-size: 9px; color: #666;">${player.rating}</div>
                    </div>
                `;
            });
            formationHTML += '</div>';

            // Goalkeeper (bottom)
            if (selectedTeam.goalkeeper) {
                formationHTML += '<div style="display: flex; justify-content: center; width: 100%; align-items: center;">';
                formationHTML += `
                    <div style="background: rgba(255,193,7,0.9); color: #1e3c72; padding: 8px 12px; border-radius: 20px; font-size: 11px; font-weight: bold; text-align: center; min-width: 60px; box-shadow: 0 3px 10px rgba(0,0,0,0.3); border: 2px solid #ffc107;">
                        <div>${selectedTeam.goalkeeper.name}</div>
                        <div style="font-size: 9px; color: #666;">${selectedTeam.goalkeeper.rating}</div>
                    </div>
                `;
                formationHTML += '</div>';
            }

            display.innerHTML = formationHTML;
            modal.style.display = 'flex';
        }

        // Close lineup modal
        function closeLineupModal() {
            document.getElementById('lineup-modal').style.display = 'none';
        }

        // Share lineup
        function shareLineup() {
    const modal = document.querySelector("#lineup-modal .lineup-modal-content");

    // Add watermark
    const watermark = document.createElement("div");
    watermark.textContent = "ssmoon";
    watermark.id = "ssmoon-watermark";
    watermark.style.position = "absolute";
    watermark.style.bottom = "15px";
    watermark.style.right = "20px";
    watermark.style.color = "#ffffffcc";
    watermark.style.fontSize = "14px";
    watermark.style.fontWeight = "bold";
    watermark.style.textShadow = "1px 1px 2px black";
    modal.appendChild(watermark);

    html2canvas(modal, {
        scale: 2,
        useCORS: true
    }).then(canvas => {
        canvas.toBlob(blob => {
            const imageUrl = URL.createObjectURL(blob);
            window.sharedImageUrl = imageUrl;
            openShareOptions(); // ✅ open the modal
        });

        watermark.remove();
    });
}


        // Generate strategic advice
        function generateAdvice() {
            let advice = [];
            const config = formations[currentFormation];
            
            // Check team completion
            const totalPlayers = (selectedTeam.goalkeeper ? 1 : 0) + 
                               selectedTeam.defenders.filter(p => p).length +
                               selectedTeam.midfielders.filter(p => p).length +
                               selectedTeam.forwards.filter(p => p).length;

            if (totalPlayers === 0) {
                advice.push("Start by selecting a goalkeeper - they're the foundation of any great team!");
                document.getElementById('team-advice').textContent = advice.join(' ');
                return;
            }

            // Position-specific advice
            if (!selectedTeam.goalkeeper) {
                advice.push("You need a goalkeeper! No team can function without one.");
            }

            if (selectedTeam.defenders.filter(p => p).length < config.defenders) {
                advice.push(`Your defense looks shaky - add ${config.defenders - selectedTeam.defenders.filter(p => p).length} more defender(s) to strengthen your backline.`);
            }

            if (selectedTeam.midfielders.filter(p => p).length < config.midfielders) {
                advice.push(`Midfield is where games are won - you need ${config.midfielders - selectedTeam.midfielders.filter(p => p).length} more player(s) to control the center.`);
            }

            if (selectedTeam.forwards.filter(p => p).length < config.forwards) {
                advice.push(`Who's going to score the goals? Add ${config.forwards - selectedTeam.forwards.filter(p => p).length} more forward(s) to your attack!`);
            }

            // Rating-based advice (only if position has players)
            const numForwards = selectedTeam.forwards.filter(p => p).length;
            const avgAttackRating = numForwards > 0 ? selectedTeam.forwards.filter(p => p).reduce((sum, p) => sum + p.rating, 0) / numForwards : 0;
            
            const numMidfielders = selectedTeam.midfielders.filter(p => p).length;
            const avgMidfieldRating = numMidfielders > 0 ? selectedTeam.midfielders.filter(p => p).reduce((sum, p) => sum + p.rating, 0) / numMidfielders : 0;

            const numDefenders = selectedTeam.defenders.filter(p => p).length;
            const avgDefenseRating = (numDefenders + (selectedTeam.goalkeeper ? 1 : 0)) > 0 ? 
                                     (selectedTeam.defenders.filter(p => p).reduce((sum, p) => sum + p.rating, 0) + (selectedTeam.goalkeeper ? selectedTeam.goalkeeper.rating : 0)) / (numDefenders + (selectedTeam.goalkeeper ? 1 : 0)) : 0;


            if (numForwards > 0 && avgAttackRating < 85 && numForwards === config.forwards) {
                advice.push("Consider upgrading your attack with higher-rated forwards for more goals.");
            }

            if (numMidfielders > 0 && avgMidfieldRating < 85 && numMidfielders === config.midfielders) {
                advice.push("A stronger midfield will give you better control of the game.");
            }

            if ((numDefenders + (selectedTeam.goalkeeper ? 1 : 0)) > 0 && avgDefenseRating < 85 && numDefenders === config.defenders && selectedTeam.goalkeeper) {
                advice.push("Boost your defense with higher-rated defenders or a top goalkeeper.");
            }


            if (totalPlayers === 11) {
                const overallRatingText = document.getElementById('overall-rating').textContent;
                const overallRating = parseInt(overallRatingText.split('/')[0]); // Parse "85/100" to 85
                if (overallRating >= 88) {
                    advice.push("🔥 Incredible team! This squad could win any tournament!");
                } else if (overallRating >= 85) {
                    advice.push("💪 Solid team! You're ready to compete at the highest level.");
                } else if (overallRating >= 80) {
                    advice.push("👍 Good team balance, but there's room for improvement in key positions.");
                } else {
                    advice.push("⚡ You have a complete team! Focus on upgrading weaker positions.");
                }
            }

            if (advice.length === 0) {
                advice.push("Looking good! Keep building your dream team.");
            }

            document.getElementById('team-advice').textContent = advice.join(' ');
        }


        // Update player availability highlighting
        function updatePlayerAvailability() {
            // Remove 'selected' class from all player cards first
            document.querySelectorAll('.player-card').forEach(card => {
                card.classList.remove('selected');
                card.style.backgroundColor = 'rgba(255,255,255,0.15)'; // Reset background
                card.style.border = 'none'; // Reset border
                card.style.color = 'white'; // Reset text color
                card.style.cursor = 'pointer'; // Reset cursor
                // Re-add click listener if it was removed
                const playerName = card.textContent.trim().split(' ')[0];
                const positionMap = {
                    'gk-players': 'goalkeepers',
                    'def-players': 'defenders', 
                    'mid-players': 'midfielders',
                    'fwd-players': 'forwards'
                };
                const containerId = card.closest('.player-list').id;
                const playerPosition = positionMap[containerId];
                const playerRating = parseInt(card.querySelector('.player-rating').textContent);
                card.onclick = () => selectPlayer(playerName, playerPosition, playerRating);
            });

            // If a slot is clicked, highlight players for that specific position
            if (currentSelectionPosition) {
                const positionMap = {
                    'goalkeeper': 'gk',
                    'defenders': 'def',
                    'midfielders': 'mid',
                    'forwards': 'fwd'
                };

                const targetContainerId = `${positionMap[currentSelectionPosition]}-players`;
                document.querySelectorAll(`#${targetContainerId} .player-card`).forEach(card => {
                    const playerName = card.textContent.trim().split(' ')[0]; // Extract name from card text
                    const isPlayerInTeam = Object.values(selectedTeam).flat().some(p => p && p.name === playerName);
                    
                    if (!isPlayerInTeam) {
                        card.classList.add('selected'); // Apply selected style if available
                        card.style.backgroundColor = 'rgba(0,255,136,0.2)';
                        card.style.border = '2px solid #00ff88';
                    }
                });
            }

            // Disable (visually and functionally) players already in the team across all lists
            Object.values(selectedTeam).flat().forEach(player => {
                if (player) {
                    document.querySelectorAll('.player-card').forEach(card => {
                        // Check if the card's text content includes the player's name
                        // This comparison is robust enough as player names are unique in this context
                        if (card.textContent.includes(player.name)) {
                            card.style.backgroundColor = 'rgba(255,255,255,0.05)'; // Dim background
                            card.style.color = 'rgba(255,255,255,0.5)';
                            card.style.cursor = 'not-allowed';
                            const ratingSpan = card.querySelector('.player-rating');
                            if (ratingSpan) {
                                ratingSpan.style.color = 'rgba(0,255,136,0.5)';
                            }
                            card.onclick = null; // Disable click
                        }
                    });
                }
            });
        }


        // Clear the entire team
        function clearTeam() {
            selectedTeam = {
                goalkeeper: null,
                defenders: [],
                midfielders: [],
                forwards: []
            };

            // Reset pitch display
            document.querySelectorAll('.player-slot').forEach(slot => {
                slot.classList.remove('filled');
                const positionDiv = slot.closest('.formation-line');
                if (positionDiv) {
                    if (positionDiv.id === 'goalkeeper') {
                        slot.textContent = 'GK';
                    } else if (positionDiv.id === 'defenders') {
                        slot.textContent = 'DEF';
                    } else if (positionDiv.id === 'midfielders') {
                        slot.textContent = 'MID';
                    } else if (positionDiv.id === 'forwards') {
                        slot.textContent = 'FWD';
                    }
                }
            });

            currentSelectionPosition = null;
            currentSelectionIndex = null;
            updateTeamStats();
            generateAdvice();
            updatePlayerAvailability();
            showSmartSuggestions();
        }

        // Initialize app when page loads
        window.onload = init;
function downloadLineupImage() {
    const modal = document.querySelector("#lineup-modal .lineup-modal-content");

    // Add temporary watermark
    let watermark = document.createElement("div");
    watermark.textContent = "ssmoon";
    watermark.style.position = "absolute";
    watermark.style.bottom = "15px";
    watermark.style.right = "20px";
    watermark.style.color = "#ffffffcc";
    watermark.style.fontSize = "14px";
    watermark.style.fontWeight = "bold";
    watermark.style.textShadow = "1px 1px 2px black";
    watermark.style.zIndex = "9999";
    watermark.style.pointerEvents = "none";
    watermark.id = "ssmoon-watermark";
    modal.appendChild(watermark);

    html2canvas(modal, {
        scale: 2,
        useCORS: true
    }).then(canvas => {
        const link = document.createElement('a');
        link.download = `${teamName.replace(/\s+/g, '_')}_Card.png`;
        link.href = canvas.toDataURL();
        link.click();

        // Remove watermark after capture
        watermark.remove();
    });
}
function openShareOptions() {
    document.getElementById("share-options-modal").style.display = "flex";
}

function closeShareOptions() {
    document.getElementById("share-options-modal").style.display = "none";
}

function shareToPlatform(platform) {
    const text = `🔥 Check out my fantasy team "${teamName}" built on ssmoon!`;
    const url = window.location.href;

    switch(platform) {
        case 'facebook':
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`, '_blank');
            break;
        case 'x':
            window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`, '_blank');
            break;
        case 'telegram':
            window.open(`https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(text)}`, '_blank');
            break;
        case 'instagram':
            alert("📷 Your image has been downloaded. Please upload it manually to Instagram.");
            const link = document.createElement('a');
            link.href = window.sharedImageUrl;
            link.download = `${teamName.replace(/\s+/g, '_')}_Card.png`;
            link.click();
            break;
        case 'kakao':
            window.open("https://www.kakao.com/services/api", "_blank"); // or your own Kakao Link logic
            break;
    }
}


    </script>
</body>
</html>
